(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[687],{5928:function(t,e,n){Promise.resolve().then(n.bind(n,114))},114:function(t,e,n){"use strict";n.d(e,{default:function(){return l}});var r=n(7437),s=n(2265),o=n(6463),a=n(6264),c=n(9233);function i(t){let{tabs:e,active:n,onChange:s}=t;return(0,r.jsx)("div",{className:"tabs",role:"tablist",children:e.map(t=>(0,r.jsx)("button",{role:"tab","aria-selected":n===t.key,className:"tab ".concat(n===t.key?"active":""),onClick:()=>s(t.key),children:t.label},t.key))})}function l(t){var e,n;let{company:l}=t,u=(0,o.useRouter)(),[d,h]=(0,s.useState)(null),[f,m]=(0,s.useState)("1");async function E(){try{let t=await (0,a.R1)("/api/results/".concat(encodeURIComponent(l)));h(t)}catch(t){}}(0,s.useEffect)(()=>{E();let t=setInterval(E,1e4);return()=>clearInterval(t)},[l]);let p=((null==d?void 0:d.queries)||[]).slice(0,5).map((t,e)=>({key:String(e+1),label:t})),w=Number(f)-1,x=null==d?void 0:null===(e=d.items)||void 0===e?void 0:e[w],y=(null==d?void 0:d.status)==="running",v=(null==d?void 0:null===(n=d.items)||void 0===n?void 0:n.some(t=>t.text&&t.text.trim()||t.markdown&&t.markdown.trim()))||!1;return(0,r.jsxs)("div",{className:"container",children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,r.jsx)("h1",{style:{margin:0},children:l}),!y&&v&&(0,r.jsx)("button",{className:"btn",onClick:()=>u.push("/company/".concat(encodeURIComponent(l),"/proposal")),style:{marginLeft:"auto"},children:"提案を作成"})]}),(null==d?void 0:d.progress)&&(0,r.jsxs)("p",{className:"muted",children:["進捗: ",d.progress.completed," / ",d.progress.total]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[y&&(0,r.jsx)("div",{className:"spinner"}),(0,r.jsx)("span",{children:y?"実行中… 完了までしばらくお待ちください。":(null==d?void 0:d.status)==="completed"?"完了":"未実行"})]}),(0,r.jsx)("div",{style:{height:12}}),(0,r.jsx)("div",{style:{display:"flex",gap:8,marginBottom:8},children:(0,r.jsx)("button",{className:"btn",onClick:()=>u.push("/"),children:"← 戻る"})}),p.length>0&&(0,r.jsx)(i,{tabs:p,active:f,onChange:m}),x&&(0,r.jsx)("div",{children:(0,r.jsx)(c.Z,{content:x.markdown||x.text||""})})]})}},9233:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(7437);n(2265);var s=n(27),o=n(7601);function a(t){let{content:e}=t;return(0,r.jsx)(s.U,{remarkPlugins:[o.Z],components:{a:t=>{let{node:e,...n}=t;return(0,r.jsx)("a",{...n})},h1:t=>{let{node:e,...n}=t;return(0,r.jsx)("h2",{...n})},h2:t=>{let{node:e,...n}=t;return(0,r.jsx)("h3",{...n})}},children:e||""})}},6264:function(t,e,n){"use strict";async function r(t){try{let e=await fetch(t,{next:{revalidate:0}});if(!e.ok){let n="GET ".concat(t," ").concat(e.status);try{let t=await e.json();t.detail&&(n=t.detail)}catch(r){n="GET ".concat(t," ").concat(e.status," ").concat(e.statusText)}throw Error(n)}return e.json()}catch(t){if(t instanceof Error){if(t.message.includes("Failed to fetch")||t.message.includes("NetworkError"))throw Error("ネットワークエラーが発生しました。接続を確認してください。");throw t}throw Error("予期しないエラーが発生しました")}}async function s(t,e,n){let r=(null==n?void 0:n.timeout)||6e5,s=new AbortController,o=setTimeout(()=>s.abort(),r);try{let n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:s.signal});if(clearTimeout(o),!n.ok){let e="POST ".concat(t," ").concat(n.status);try{let t=await n.json();t.detail&&(e=t.detail)}catch(r){e="POST ".concat(t," ").concat(n.status," ").concat(n.statusText)}throw Error(e)}return n.json()}catch(t){if(clearTimeout(o),t instanceof Error){if("AbortError"===t.name)throw Error("リクエストがタイムアウトしました。時間がかかりすぎている可能性があります。しばらく待ってから再試行してください。");if(t.message.includes("Failed to fetch")||t.message.includes("NetworkError"))throw Error("ネットワークエラーが発生しました。接続を確認してください。");throw t}throw Error("予期しないエラーが発生しました")}}async function o(t){try{let e=await fetch(t,{method:"DELETE"});if(!e.ok){let n="DELETE ".concat(t," ").concat(e.status);try{let t=await e.json();t.detail&&(n=t.detail)}catch(r){n="DELETE ".concat(t," ").concat(e.status," ").concat(e.statusText)}throw Error(n)}return e.json()}catch(t){if(t instanceof Error){if(t.message.includes("Failed to fetch")||t.message.includes("NetworkError"))throw Error("ネットワークエラーが発生しました。接続を確認してください。");throw t}throw Error("予期しないエラーが発生しました")}}n.d(e,{QW:function(){return o},R1:function(){return r},sg:function(){return s}})}},function(t){t.O(0,[760,971,23,744],function(){return t(t.s=5928)}),_N_E=t.O()}]);